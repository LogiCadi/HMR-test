# 热更新（HMR）的原理简单示例

## 什么是热更新

手动刷新：更新代码后，需要手动刷新页面，操作繁琐

自动刷新：检测到代码更新后，自动刷新页面，响应速度快，但页面上的状态丢失，比如复选框的选中状态、输入框的输入等刷新后就重置了

热更新：不重载页面，只局部刷新页面上发生变化的模块，同时可以保留当前的页面状态

## 基本原理

代码修改后，通知客户端哪个文件发生了改变，客户端只请求指定文件并执行代码，不重载 html

- 本地服务监听代码文件修改
- 通过 socket 推送修改消息
- 客户端获取 js 或 css 代码并执行

## 优缺点

优点：响应速度快，页面无感知，页面状态得到保留

缺点：只能更新 js 和 css，html 更新仍需重载页面。相比于重载页面简单粗暴的方法，热更新执行逻辑更复杂，对工程化要求更高

## 代码说明

先启动本地服务

```sh
cd src
node server.js
```

浏览器打开 [http://127.0.0.1:8001/index.html](http://127.0.0.1:8001/index.html)

修改 input.js 和 text.js，页面上只更新各自的部分
